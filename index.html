<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AyÅŸe Nur iÃ§in Hava Durumu ve Giyim Ã–nerisi</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            text-align: center;
            padding: 20px;
            margin: 0;
            background-color: #f4f4f4;
        }
        #container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1024px;
            margin: 0 auto;
            gap: 20px;
        }

        .left-column {
            flex: 1 1 300px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .right-column {
            flex: 2 1 600px;
        }

        .card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        #clothingImage {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        #weatherTable {
            width: 100%;
            border-collapse: collapse;
        }

        #weatherTable th, #weatherTable td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        @media (max-width: 768px) {
            #container {
                flex-direction: column;
            }
            .left-column, .right-column {
                flex-basis: 100%;
            }
        }
    </style>
</head>
<body>

<div id="container">
    <div class="left-column">
        <div class="card">
            <h1>LÃ¼tfen Ã¶teki sitedeki zÃ¼rafaya tÄ±klar mÄ±sÄ±nÄ±z? ðŸ˜Š </h1>
            <h1>BugÃ¼n Hava Durumu </h1>
            <div id="currentWeather">YÃ¼kleniyor...</div>
        </div>
        <div class="card">
            <h1>YarÄ±n iÃ§in Hava Durumu </h1>
            <div id="forecastWeather">YÃ¼kleniyor...</div>
        </div>
        <div class="card">
            <h1>YarÄ±n iÃ§in Ã–neri</h1>
            <div class="result" id="result"></div>
        </div>
    </div>
    <div class="right-column">
        <div class="card">
            <img id="clothingImage" src="" alt="Giysi GÃ¶rseli">
        </div>
                <div class="card">
            <h1>5 GÃ¼nlÃ¼k Hava Durumu GrafiÄŸi</h1>
            <canvas id="weatherChart"></canvas>
        </div>
        <div class="card">
            <h1>5 GÃ¼nlÃ¼k Hava Durumu Tablosu</h1>
            <table id="weatherTable">
                <thead>
                    <tr>
                        <th>Tarih</th>
                        <th>Saat</th>
                        <th>SÄ±caklÄ±k (Â°C)</th>
                        <th>Durum</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>




<script>
    const apiKey = 'b07a07d493ce339fda67b34fb5db1dfe'; // API anahtarÄ±nÄ±zÄ± buraya girin

    async function fetchWeather() {
        try {
           const currentWeatherResponse = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=panderma,tr&appid=${apiKey}&units=metric&lang=tr`);
            const currentWeatherData = await currentWeatherResponse.json();

            const forecastWeatherResponse = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=panderma,tr&appid=${apiKey}&units=metric&lang=tr`);
            const forecastWeatherData = await forecastWeatherResponse.json();


            displayCurrentWeather(currentWeatherData);
            displayForecastWeather(forecastWeatherData);
            getClothingSuggestion(forecastWeatherData);
            display5DayForecast(forecastWeatherData);

        } catch (error) {
            document.getElementById('currentWeather').innerText = 'Veri alÄ±nÄ±rken bir hata oluÅŸtu!';
            document.getElementById('forecastWeather').innerText = 'Veri alÄ±nÄ±rken bir hata oluÅŸtu!';
            console.error('API HatasÄ±:', error);
        }
    }

    function displayCurrentWeather(data) {
        const weatherDiv = document.getElementById('currentWeather');
        weatherDiv.innerHTML = `
            <p>SÄ±caklÄ±k: ${data.main.temp} Â°C</p>
            <p>Hissedilen SÄ±caklÄ±k: ${data.main.feels_like} Â°C</p>
            <p>Nem: ${data.main.humidity}%</p>
            <p>Durum: ${data.weather[0].description}</p>
        `;
    }

    function displayForecastWeather(data) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        const tomorrowDateString = tomorrow.toISOString().slice(0, 10);

        let tomorrowForecast;
        for (let i = 0; i < data.list.length; i++) {
            if (data.list[i].dt_txt.startsWith(tomorrowDateString)) {
                tomorrowForecast = data.list[i];
                break;
            }
        }

        const forecastDiv = document.getElementById('forecastWeather');
                    if (tomorrowForecast) {
                const iconCode = tomorrowForecast.weather[0].icon;
                const iconUrl = `http://openweathermap.org/img/wn/${iconCode}@2x.png`;


                forecastDiv.innerHTML = `
                <p>SÄ±caklÄ±k: ${tomorrowForecast.main.temp} Â°C</p>
                <p>Hissedilen SÄ±caklÄ±k: ${tomorrowForecast.main.feels_like} Â°C</p>
                <p>Nem: ${tomorrowForecast.main.humidity}%</p>
                <p>Durum: ${tomorrowForecast.weather[0].description}</p>
                <img src="${iconUrl}" alt="${tomorrowForecast.weather[0].description}">
            `;
            } else {
                forecastDiv.innerHTML = `<p>YarÄ±n iÃ§in hava durumu bilgisi bulunamadÄ±.</p>`;
            }
        
        
    }

    function getClothingSuggestion(data) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        const tomorrowDateString = tomorrow.toISOString().slice(0, 10);

        let tomorrowForecast;
        for (let i = 0; i < data.list.length; i++) {
            if (data.list[i].dt_txt.startsWith(tomorrowDateString)) {
                tomorrowForecast = data.list[i];
                break;
            }
        }

        if (!tomorrowForecast) {
            document.getElementById('result').innerHTML = "<p>YarÄ±n iÃ§in hava durumu bilgisi bulunamadÄ±, bu yÃ¼zden Ã¶neri yapÄ±lamÄ±yor.</p>";
            return;
        }

        const temp = tomorrowForecast.main.temp;
        let suggestion = '';
        let imageSrc = '';

        if (temp >= 25) {
            suggestion = `SÄ±cak havalar iÃ§in hafif ve nefes alabilen kumaÅŸlar tercih edin. TiÅŸÃ¶rt ve ÅŸort giymek idealdir. Parlak ve aÃ§Ä±k renkler (beyaz, aÃ§Ä±k mavi, pastel tonlarÄ±) gÃ¼neÅŸ Ä±ÅŸÄ±nlarÄ±nÄ± daha az Ã§eker, bu yÃ¼zden aÃ§Ä±k tonlarda giyinmeyi unutmayÄ±n. AyrÄ±ca, gÃ¶zlerinizi korumak iÃ§in gÃ¼neÅŸ gÃ¶zlÃ¼ÄŸÃ¼ ve ÅŸapka da aksesuar olarak gÃ¼zel bir tamamlayÄ±cÄ± olur.`;
             imageSrc = 'tshirt-sort.png';
        } else if (temp >= 15 && temp < 25) {
            suggestion = `Bahar havasÄ± gibi hafif serin havalarda, ince bir ceket veya kot ceket ideal olur. Renk olarak gri, lacivert, haki gibi tonlar sonbahar iÃ§in harika tercihlerdir. Hafif bir atkÄ± ya da ÅŸÄ±k bir fular da kÄ±yafetinizi zenginleÅŸtirir. AltÄ±na rahat bir jean veya ince kumaÅŸ pantolon giymeyi dÃ¼ÅŸÃ¼nebilirsiniz.`;
            imageSrc = 'ceket.png';
        } else if (temp >= 5 && temp < 15) {
            suggestion = `Serin havalarda daha kalÄ±n kÄ±yafetlere ihtiyaÃ§ var. Uzun kollu kazaklar, hÄ±rkalar ve montlar giyebilirsiniz. Renklerde ise koyu tonlar (bordo, koyu yeÅŸil, siyah) hem sÄ±cak tutar hem de ÅŸÄ±k durur. AyrÄ±ca bot veya spor ayakkabÄ± seÃ§imi iyi olur. KalÄ±n Ã§oraplar giymeyi unutmayÄ±n!`;
            imageSrc = 'kazak.png';
        } else {
            suggestion = `SoÄŸuk havalarda kesinlikle kalÄ±n montlar, kazaklar, eldiven ve bere gibi aksesuarlar gereklidir. KatmanlÄ± giyinmek Ã¶nemlidir; iÃ§e termal iÃ§lik, Ã¼stÃ¼ne yÃ¼n kazak ve kalÄ±n bir kaban tercih edebilirsiniz. Renklerde ise sÄ±cak tonlar (kÄ±rmÄ±zÄ±, turuncu) tercih edilebilir. AyaklarÄ±nÄ±zÄ± sÄ±cak tutmak iÃ§in yÃ¼n Ã§orap ve bot giyin.`;
            imageSrc = 'mont.png';
        }


        document.getElementById('result').innerHTML = suggestion;
        document.getElementById('clothingImage').src = imageSrc;
    }

function display5DayForecast(data) {
    const tableBody = document.getElementById('weatherTable').querySelector('tbody');
    tableBody.innerHTML = ''; // Tabloyu temizle

    const chartData = {
        labels: [],
        datasets: [{
            label: 'SÄ±caklÄ±k (Â°C)',
            data: [],
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.4
        }]
    };

    for (const item of data.list) {
        const date = new Date(item.dt * 1000);
        const dateString = date.toLocaleDateString('tr-TR');
        const timeString = date.toLocaleTimeString('tr-TR');
        const temperature = item.main.temp;
        const description = item.weather[0].description;
            
        const row = tableBody.insertRow();
        row.insertCell().textContent = dateString;
        row.insertCell().textContent = timeString;
        row.insertCell().textContent = temperature;
        row.insertCell().textContent = description;

        chartData.labels.push(`${dateString} ${timeString}`);
        chartData.datasets[0].data.push(temperature);
        const iconCode = item.weather[0].icon;
                const iconUrl = `http://openweathermap.org/img/wn/${iconCode}@2x.png`; // Ä°kon URL'si

                const iconCell = row.insertCell(); // Yeni hÃ¼cre ekle
                const iconImg = document.createElement('img'); // Resim elementi oluÅŸtur
                iconImg.src = iconUrl;
                iconImg.alt = description;
                iconCell.appendChild(iconImg);
    }

    const ctx = document.getElementById('weatherChart');
    new Chart(ctx, {
        type: 'line',
        data: chartData,
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'SÄ±caklÄ±k (Â°C)'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Tarih ve Saat'
                    }
                }
            }
        }
    });
}


    window.onload = function() {
        fetchWeather();
        setInterval(fetchWeather, 100000);  // Her 10 dakikada bir gÃ¼ncelleme
    };
</script>

</body>
</html>
